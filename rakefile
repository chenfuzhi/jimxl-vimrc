#encoding: utf-8
require 'fileutils'

def install_vundle
    FileUtils.mkdir_p File.join(Dir.home, '.vim/bundle/')
    FileUtils.cp_r 'vundle', File.join(Dir.home, '.vim/bundle/')
    system("vim +BundleInstall +qall")
end

def install_vimrc
    FileUtils.cp 'vimrc', File.join(Dir.home, '.vimrc')
end

def install_needed_software
    system("sudo apt-get install wmctrl")
    system("sudo apt-get install ack-grep")
end

def compile_vimprocess
    Dir.chdir(File.join(Dir.home, '.vim/bundle/vimproc')) do
        system("make -f make_unix.mak")
    end
end

desc '安装vim插件以及vim配置文件'
task :install do
    install_needed_software
    install_vimrc
    install_vundle
    compile_vimprocess
end


desc '清除安装的插件和配置文件'
task :uninstall do
    FileUtils.rm_rf File.join(Dir.home, '.vimrc'), File.join(Dir.home, '.vim')
end

desc '更新已经安装的插件,安装新添加的插件'
task :update do
    install_vimrc
    system("vim +BundleInstall! +qall")
end

desc '安装新添加的插件'
task :install_new_plugin do
    install_vimrc
    system("vim +BundleInstall +qall")
end

desc '更新vimrc文件'
task :update_vimrc do
    install_vimrc
end

desc '安装中文帮助'
task :install_cn_doc do
    system("wget http://prdownloads.sourceforge.net/vimcdoc/vimcdoc-1.8.0.tar.gz") unless File.file?('vimcdoc-1.8.0.tar.gz')
    system("tar zxvf vimcdoc-1.8.0.tar.gz")
    Dir.chdir('vimcdoc-1.8.0') do
        system('./vimcdoc.sh -i')
    end
end
